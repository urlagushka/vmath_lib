/* File converted with FORTRAN CONVERTER utility.
   FORTRAN CONVERTER is written by Grigoriev D., 2081/4.*/

#include "forsythe.h"

static int IY;
void INIT_URAND(int I)
{
    IY = I;
}

REAL URAND()
{

//       URAND-TO ATK PABHOMEPHO PACPEEEHHX CAHX
//     CE, OCHOBAHH HA TEOP  PEOEHX, COEPAXC
//     B KHE KHT (1969),TOM 2.
//       EPE EPBM OPAEHEM K URAND EO EPEMEHHO IY
//     CEET PCBOT POBOHOE EOCEHHOE HAA-
//     HOE HAEHE. BBAA POPAMMA HE OHA MEHT
//     HAEHE IY ME OCEOBATEHM BOBAM. HAEH
//     HK URAND BTC CAM  HTEPBAA (0,1).

static IA,IC,M,MIC;
static double HALFM;
static REAL S;
static M2 = 0, ITWO = 2;
if(M2!=0)goto _20;

//     EC TO EPB BXO, TO BCT H
//     EOCEHHOO MAHHOO COBA

M=1;
_10:;
M2=M;
M=ITWO*M2;
if(M > M2)goto _10;
HALFM=M2;

//     BCT MHOTE  PPAEHE HEHOO
//     KOHPHTHOO METOA

IA=8*int(HALFM*atan(1.0)/8.0)+5;
IC=2*int(HALFM*(0.5-sqrt(3.0)/6.0))+1;
MIC=(M2-IC)+M2;

//     S-MACTAP MHOTE  PEOPAOBAH B CO
//     C ABAE TOKO

S=0.5/HALFM;

//     BCT CEEE CAHOE CO

_20:;
IY=IY*IA;

//     CE OEPATOP- MAH,KOTOPE HE OCKAT
//     EPEOHEH EX CE P COEH

if(IY>MIC)IY=(IY-M2)-M2;
IY=IY+IC;

//     CE OEPATOP -  MAH,  KOTOPX HA COBA
//      COEH OE, EM  MHOEH

if(IY/2>M2)IY=(IY-M2)-M2;

//     CE OEPATOP -  MAH,  KOTOPX EPEOHEHE
//     EOO CA BET HA HAKOB PAP

if(IY<0)IY=(IY+M2)+M2;
return REAL(IY)*S;
}                         	// END
